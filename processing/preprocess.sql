create index home_idx on elo(home_id);
create index visitor_idx on elo(visitor_id); 
create index team_idx on team_efficiency(team_id); 
alter table elo add column home_per decimal(10, 2); 
update elo a join team_efficiency b on a.home_id = b.team_id and a.season = b.year set a.home_per = b.per;
alter table elo add column visitor_per decimal(10, 2);
update elo a join team_efficiency b on a.visitor_id = b.team_id and a.season = b.year set a.visitor_per = b.per;
alter table elo add column home_victory int;
update elo set home_victory = 1 where mov > 0;
update elo set home_victory = 0 where mov < 0;
alter table elo add column h_fg int, add column h_stl int, add column h_3p int, add column h_ft int, add column h_blk int, add column h_orb int, add column h_ast int, add column h_drb int, add column h_pf int, add column h_ftm int, add column h_fgm int, add column h_tov int, add column v_fg int, add column v_stl int, add column v_3p int, add column v_ft int, add column v_blk int, add column v_orb int, add column v_ast int, add column v_drb int, add column v_pf int, add column v_ftm int, add column v_fgm int, add column v_tov int;
update elo a join team_total b on a.home_id = b.team_id and a.season = b.year set a.h_fg = b.fg, a.h_stl = b.stl, a.h_3p = b.3p, a.h_ft = b.ft, a.h_blk = b.blk, a.h_orb = b.orb, a.h_ast = b.ast, a.h_drb = b.drb, a.h_pf = b.pf, a.h_ftm = b.fta - b.ft, a.h_fgm = b.fga - b.fg, a.h_tov = b.tov;
update elo a join team_total b on a.visitor_id = b.team_id and a.season = b.year set a.v_fg = b.fg, a.v_stl = b.stl, a.v_3p = b.3p, a.v_ft = b.ft, a.v_blk = b.blk, a.v_orb = b.orb, a.v_ast = b.ast, a.v_drb = b.drb, a.v_pf = b.pf, a.v_ftm = b.fta - b.ft, a.v_fgm = b.fga - b.fg, a.v_tov = b.tov;